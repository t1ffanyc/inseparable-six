{
  "experiment_name": "dp_gradient_norm_lora",
  "config": {
    "name": "fast_comparison",
    "output_dir": "./experiment_results",
    "model_name": "distilbert-base-uncased",
    "dataset_name": "ag_news",
    "max_train_samples": 1000,
    "max_test_samples": 500,
    "max_length": 32,
    "batch_size": 32,
    "epochs": 1,
    "learning_rate": 0.0005,
    "weight_decay": 0.01,
    "seed": 42,
    "lora_rank": 4,
    "lora_alpha": 8,
    "lora_dropout": 0.1,
    "lora_target_modules": [
      "q_lin",
      "v_lin"
    ],
    "target_epsilon": 0.5,
    "target_delta": null,
    "max_grad_norm": 1.0,
    "gradient_estimation_samples": 50,
    "use_public_data_for_estimation": false,
    "run_no_dp": true,
    "run_strategies": [
      "uniform",
      "gradient_norm",
      "cube_root_gradient_norm",
      "depth_linear_increasing"
    ],
    "device": "cpu"
  },
  "epochs": [
    {
      "epoch": 0,
      "train_loss": 1.3033576384186745,
      "train_accuracy": 47.57665677546983,
      "eval_loss": 1.4397411495447159,
      "eval_accuracy": 25.4,
      "epsilon": 0.5055686229775292,
      "delta": 0.001,
      "mean_gradient_norm": null,
      "mean_clipped_fraction": null,
      "epoch_time_seconds": 49.74867916107178,
      "peak_gpu_memory_mb": 0.0,
      "steps": [
        {
          "step": 0,
          "epoch": 0,
          "loss": 1.390870213508606,
          "accuracy": 20.0,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.2770724088773902,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1235.7027530670166,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 1,
          "epoch": 0,
          "loss": 1.3896937370300293,
          "accuracy": 28.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.29779567541520474,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 855.942964553833,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 2,
          "epoch": 0,
          "loss": 1.3567473888397217,
          "accuracy": 46.666666666666664,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.3057646202295503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 997.7071285247803,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 3,
          "epoch": 0,
          "loss": 1.3632150888442993,
          "accuracy": 29.166666666666668,
          "batch_size": 24,
          "learning_rate": 0.0005,
          "epsilon": 0.3137335650438959,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 794.9662208557129,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 4,
          "epoch": 0,
          "loss": 1.3648409843444824,
          "accuracy": 41.666666666666664,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.32170250985824145,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1190.356969833374,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 5,
          "epoch": 0,
          "loss": 1.3329657316207886,
          "accuracy": 60.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.32967145467258696,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 989.2959594726562,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 6,
          "epoch": 0,
          "loss": 1.3506319522857666,
          "accuracy": 38.46153846153846,
          "batch_size": 39,
          "learning_rate": 0.0005,
          "epsilon": 0.33764039948693253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1792.1302318572998,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 7,
          "epoch": 0,
          "loss": 1.3500772714614868,
          "accuracy": 50.0,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.3456093443012781,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1376.842975616455,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 8,
          "epoch": 0,
          "loss": 1.3241455554962158,
          "accuracy": 57.142857142857146,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.3535782891156236,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1156.1968326568604,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 9,
          "epoch": 0,
          "loss": 1.3416374921798706,
          "accuracy": 50.0,
          "batch_size": 20,
          "learning_rate": 0.0005,
          "epsilon": 0.3615472339299692,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 841.9599533081055,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 10,
          "epoch": 0,
          "loss": 1.32016122341156,
          "accuracy": 50.0,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.36951617874431475,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1391.2010192871094,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 11,
          "epoch": 0,
          "loss": 1.2978700399398804,
          "accuracy": 54.54545454545455,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.37748512355866026,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1324.0869045257568,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 12,
          "epoch": 0,
          "loss": 1.3398767709732056,
          "accuracy": 41.666666666666664,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.38545406837300583,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1580.9659957885742,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 13,
          "epoch": 0,
          "loss": 1.3099607229232788,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.3934230131873514,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1388.5540962219238,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 14,
          "epoch": 0,
          "loss": 1.3067750930786133,
          "accuracy": 55.55555555555556,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.4013919580016969,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1604.0878295898438,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 15,
          "epoch": 0,
          "loss": 1.2945798635482788,
          "accuracy": 50.0,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.4093609028160425,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1138.2629871368408,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 16,
          "epoch": 0,
          "loss": 1.3061128854751587,
          "accuracy": 45.714285714285715,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.4162704111688099,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1340.149164199829,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 17,
          "epoch": 0,
          "loss": 1.3020497560501099,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.42222362528939117,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1259.145975112915,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 18,
          "epoch": 0,
          "loss": 1.3281477689743042,
          "accuracy": 42.30769230769231,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.42817683940997253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1115.123987197876,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 19,
          "epoch": 0,
          "loss": 1.276521921157837,
          "accuracy": 52.77777777777778,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.4341300535305538,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1351.6840934753418,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 20,
          "epoch": 0,
          "loss": 1.2764829397201538,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.44008326765113503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1338.43994140625,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 21,
          "epoch": 0,
          "loss": 1.3280326128005981,
          "accuracy": 41.1764705882353,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.4460364817717163,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1553.497076034546,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 22,
          "epoch": 0,
          "loss": 1.1818996667861938,
          "accuracy": 64.51612903225806,
          "batch_size": 31,
          "learning_rate": 0.0005,
          "epsilon": 0.45198969589229765,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1230.907917022705,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 23,
          "epoch": 0,
          "loss": 1.224027395248413,
          "accuracy": 58.69565217391305,
          "batch_size": 46,
          "learning_rate": 0.0005,
          "epsilon": 0.4579429100128789,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 2164.4020080566406,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 24,
          "epoch": 0,
          "loss": 1.2203353643417358,
          "accuracy": 56.25,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.46389612413346015,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1443.9129829406738,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 25,
          "epoch": 0,
          "loss": 1.2676115036010742,
          "accuracy": 50.0,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.4698493382540415,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1506.687879562378,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 26,
          "epoch": 0,
          "loss": 1.1805225610733032,
          "accuracy": 60.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.47580255237462277,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 855.30686378479,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 27,
          "epoch": 0,
          "loss": 1.3620599508285522,
          "accuracy": 30.555555555555557,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.481755766495204,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1552.823781967163,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 28,
          "epoch": 0,
          "loss": 1.3476057052612305,
          "accuracy": 36.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.4877089806157854,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1094.4247245788574,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 29,
          "epoch": 0,
          "loss": 1.2261111736297607,
          "accuracy": 51.42857142857143,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.49366219473636663,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1414.8800373077393,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 30,
          "epoch": 0,
          "loss": 1.2130777835845947,
          "accuracy": 53.57142857142857,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.4996154088569479,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1004.1460990905762,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 31,
          "epoch": 0,
          "loss": 1.232796311378479,
          "accuracy": 50.0,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.5055686229775292,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1285.3479385375977,
          "gpu_memory_mb": 0.0
        }
      ]
    }
  ],
  "final_train_loss": 1.3033576384186745,
  "final_train_accuracy": 47.57665677546983,
  "final_eval_accuracy": 25.4,
  "final_epsilon": 0.5055686229775292,
  "final_delta": 0.001,
  "allocation_metrics": {
    "strategy_name": "gradient_norm_private",
    "layer_clipping_bounds": {
      "other": 1.0
    },
    "allocation_ratios": {
      "other": 1.0
    },
    "global_clipping_bound": 1.0,
    "constraint_value": 1.0,
    "estimated_gradient_norms": {
      "other": 0.06585816353640703
    },
    "estimation_samples": 50,
    "privacy_cost_epsilon": 0.1,
    "used_public_data": false,
    "allocation_time_seconds": 2.1610519886016846
  },
  "model_name": "distilbert-base-uncased",
  "total_parameters": 67623944,
  "trainable_parameters": 667396,
  "lora_enabled": true,
  "total_training_time_seconds": 51.912153005599976,
  "peak_gpu_memory_mb": 0.0,
  "start_time": "2025-12-01T15:20:16.577177",
  "end_time": "2025-12-01T15:21:08.489328",
  "experiment_type": "dp",
  "strategy_name": "gradient_norm_private",
  "metadata": {}
}