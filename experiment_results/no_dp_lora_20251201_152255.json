{
  "experiment_name": "no_dp_lora",
  "config": {
    "name": "fast_comparison",
    "output_dir": "./experiment_results",
    "model_name": "distilbert-base-uncased",
    "dataset_name": "ag_news",
    "max_train_samples": 1000,
    "max_test_samples": 500,
    "max_length": 32,
    "batch_size": 32,
    "epochs": 1,
    "learning_rate": 0.0005,
    "weight_decay": 0.01,
    "seed": 42,
    "lora_rank": 4,
    "lora_alpha": 8,
    "lora_dropout": 0.1,
    "lora_target_modules": [
      "q_lin",
      "v_lin"
    ],
    "target_epsilon": 0.5,
    "target_delta": null,
    "max_grad_norm": 1.0,
    "gradient_estimation_samples": 50,
    "use_public_data_for_estimation": false,
    "run_no_dp": true,
    "run_strategies": [
      "uniform",
      "gradient_norm",
      "cube_root_gradient_norm",
      "depth_linear_increasing"
    ],
    "device": "cpu"
  },
  "epochs": [
    {
      "epoch": 0,
      "train_loss": 0.8064175029285252,
      "train_accuracy": 67.6,
      "eval_loss": 0.5050706118345261,
      "eval_accuracy": 81.4,
      "epsilon": 0.0,
      "delta": 0.0,
      "mean_gradient_norm": null,
      "mean_clipped_fraction": null,
      "epoch_time_seconds": 46.558680057525635,
      "peak_gpu_memory_mb": 0.0,
      "steps": [
        {
          "step": 0,
          "epoch": 0,
          "loss": 1.3586987257003784,
          "accuracy": 40.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 2225.0161170959473,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 1,
          "epoch": 0,
          "loss": 1.3253397941589355,
          "accuracy": 40.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1095.7708358764648,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 2,
          "epoch": 0,
          "loss": 1.3552348613739014,
          "accuracy": 28.125,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1069.101095199585,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 3,
          "epoch": 0,
          "loss": 1.1645622253417969,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 965.6879901885986,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 4,
          "epoch": 0,
          "loss": 1.1629207134246826,
          "accuracy": 46.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1033.1251621246338,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 5,
          "epoch": 0,
          "loss": 1.1461963653564453,
          "accuracy": 43.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1105.9961318969727,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 6,
          "epoch": 0,
          "loss": 0.9537105560302734,
          "accuracy": 59.375,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1128.572940826416,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 7,
          "epoch": 0,
          "loss": 1.139799952507019,
          "accuracy": 43.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1758.462905883789,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 8,
          "epoch": 0,
          "loss": 1.0459353923797607,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1419.3930625915527,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 9,
          "epoch": 0,
          "loss": 1.096463680267334,
          "accuracy": 37.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1036.247968673706,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 10,
          "epoch": 0,
          "loss": 0.8779383897781372,
          "accuracy": 65.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1094.5770740509033,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 11,
          "epoch": 0,
          "loss": 0.897216260433197,
          "accuracy": 68.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1291.6710376739502,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 12,
          "epoch": 0,
          "loss": 0.873245120048523,
          "accuracy": 65.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 997.5662231445312,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 13,
          "epoch": 0,
          "loss": 0.7650888562202454,
          "accuracy": 75.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1131.1490535736084,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 14,
          "epoch": 0,
          "loss": 0.7427769899368286,
          "accuracy": 68.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1011.7471218109131,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 15,
          "epoch": 0,
          "loss": 0.7421852946281433,
          "accuracy": 81.25,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1776.3769626617432,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 16,
          "epoch": 0,
          "loss": 0.5631385445594788,
          "accuracy": 90.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1874.1331100463867,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 17,
          "epoch": 0,
          "loss": 0.6410724520683289,
          "accuracy": 84.375,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1369.391918182373,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 18,
          "epoch": 0,
          "loss": 0.5307689309120178,
          "accuracy": 87.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1238.9230728149414,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 19,
          "epoch": 0,
          "loss": 0.5249555110931396,
          "accuracy": 84.375,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1078.8049697875977,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 20,
          "epoch": 0,
          "loss": 0.5651292204856873,
          "accuracy": 81.25,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 925.8849620819092,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 21,
          "epoch": 0,
          "loss": 0.664040207862854,
          "accuracy": 71.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1014.3563747406006,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 22,
          "epoch": 0,
          "loss": 0.6174049973487854,
          "accuracy": 75.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 940.9339427947998,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 23,
          "epoch": 0,
          "loss": 0.5153485536575317,
          "accuracy": 87.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1176.0609149932861,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 24,
          "epoch": 0,
          "loss": 0.5512391328811646,
          "accuracy": 75.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1014.8770809173584,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 25,
          "epoch": 0,
          "loss": 0.3916485607624054,
          "accuracy": 93.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1011.1439228057861,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 26,
          "epoch": 0,
          "loss": 0.4824994206428528,
          "accuracy": 90.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1120.6212043762207,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 27,
          "epoch": 0,
          "loss": 0.7019553184509277,
          "accuracy": 78.125,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1055.8760166168213,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 28,
          "epoch": 0,
          "loss": 0.6013398170471191,
          "accuracy": 87.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1187.4189376831055,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 29,
          "epoch": 0,
          "loss": 0.7626999020576477,
          "accuracy": 65.625,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1073.7242698669434,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 30,
          "epoch": 0,
          "loss": 0.8843083381652832,
          "accuracy": 68.75,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1029.9420356750488,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 31,
          "epoch": 0,
          "loss": 0.1604980081319809,
          "accuracy": 100.0,
          "batch_size": 8,
          "learning_rate": 0.0005,
          "epsilon": null,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 285.0649356842041,
          "gpu_memory_mb": 0.0
        }
      ]
    }
  ],
  "final_train_loss": 0.8064175029285252,
  "final_train_accuracy": 67.6,
  "final_eval_accuracy": 81.4,
  "final_epsilon": 0.0,
  "final_delta": 0.0,
  "allocation_metrics": null,
  "model_name": "distilbert-base-uncased",
  "total_parameters": 67623944,
  "trainable_parameters": 667396,
  "lora_enabled": true,
  "total_training_time_seconds": 46.56126809120178,
  "peak_gpu_memory_mb": 0.0,
  "start_time": "2025-12-01T15:18:33.460442",
  "end_time": "2025-12-01T15:19:20.021708",
  "experiment_type": "no_dp",
  "strategy_name": "none",
  "metadata": {}
}