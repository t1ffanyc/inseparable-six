{
  "experiment_name": "dp_cube_root_gradient_norm_lora",
  "config": {
    "name": "fast_comparison",
    "output_dir": "./experiment_results",
    "model_name": "distilbert-base-uncased",
    "dataset_name": "ag_news",
    "max_train_samples": 1000,
    "max_test_samples": 500,
    "max_length": 32,
    "batch_size": 32,
    "epochs": 1,
    "learning_rate": 0.0005,
    "weight_decay": 0.01,
    "seed": 42,
    "lora_rank": 4,
    "lora_alpha": 8,
    "lora_dropout": 0.1,
    "lora_target_modules": [
      "q_lin",
      "v_lin"
    ],
    "target_epsilon": 0.5,
    "target_delta": null,
    "max_grad_norm": 1.0,
    "gradient_estimation_samples": 50,
    "use_public_data_for_estimation": false,
    "run_no_dp": true,
    "run_strategies": [
      "uniform",
      "gradient_norm",
      "cube_root_gradient_norm",
      "depth_linear_increasing"
    ],
    "device": "cpu"
  },
  "epochs": [
    {
      "epoch": 0,
      "train_loss": 1.3120084516704082,
      "train_accuracy": 46.048780487804876,
      "eval_loss": 1.4386958107352257,
      "eval_accuracy": 25.4,
      "epsilon": 0.5055686229775292,
      "delta": 0.001,
      "mean_gradient_norm": null,
      "mean_clipped_fraction": null,
      "epoch_time_seconds": 52.09433031082153,
      "peak_gpu_memory_mb": 0.0,
      "steps": [
        {
          "step": 0,
          "epoch": 0,
          "loss": 1.3554414510726929,
          "accuracy": 36.36363636363637,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.2770724088773902,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1214.8988246917725,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 1,
          "epoch": 0,
          "loss": 1.3727715015411377,
          "accuracy": 38.46153846153846,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.29779567541520474,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 861.0661029815674,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 2,
          "epoch": 0,
          "loss": 1.3797804117202759,
          "accuracy": 31.25,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.3057646202295503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1170.4390048980713,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 3,
          "epoch": 0,
          "loss": 1.3527566194534302,
          "accuracy": 54.166666666666664,
          "batch_size": 24,
          "learning_rate": 0.0005,
          "epsilon": 0.3137335650438959,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1236.2780570983887,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 4,
          "epoch": 0,
          "loss": 1.356811285018921,
          "accuracy": 44.44444444444444,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.32170250985824145,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1487.5478744506836,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 5,
          "epoch": 0,
          "loss": 1.347190260887146,
          "accuracy": 46.15384615384615,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.32967145467258696,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1007.6799392700195,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 6,
          "epoch": 0,
          "loss": 1.356520175933838,
          "accuracy": 38.46153846153846,
          "batch_size": 39,
          "learning_rate": 0.0005,
          "epsilon": 0.33764039948693253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1480.5328845977783,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 7,
          "epoch": 0,
          "loss": 1.3345471620559692,
          "accuracy": 46.666666666666664,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.3456093443012781,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1086.2658023834229,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 8,
          "epoch": 0,
          "loss": 1.342647671699524,
          "accuracy": 40.74074074074074,
          "batch_size": 27,
          "learning_rate": 0.0005,
          "epsilon": 0.3535782891156236,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 990.2310371398926,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 9,
          "epoch": 0,
          "loss": 1.2350162267684937,
          "accuracy": 75.0,
          "batch_size": 20,
          "learning_rate": 0.0005,
          "epsilon": 0.3615472339299692,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 826.3349533081055,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 10,
          "epoch": 0,
          "loss": 1.2864516973495483,
          "accuracy": 61.76470588235294,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.36951617874431475,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1479.7980785369873,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 11,
          "epoch": 0,
          "loss": 1.3037484884262085,
          "accuracy": 48.484848484848484,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.37748512355866026,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1736.886978149414,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 12,
          "epoch": 0,
          "loss": 1.337390422821045,
          "accuracy": 40.0,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.38545406837300583,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1480.802059173584,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 13,
          "epoch": 0,
          "loss": 1.3111305236816406,
          "accuracy": 50.0,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.3934230131873514,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1249.5417594909668,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 14,
          "epoch": 0,
          "loss": 1.27455472946167,
          "accuracy": 60.526315789473685,
          "batch_size": 38,
          "learning_rate": 0.0005,
          "epsilon": 0.4013919580016969,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1454.8909664154053,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 15,
          "epoch": 0,
          "loss": 1.3156158924102783,
          "accuracy": 43.333333333333336,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.4093609028160425,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1197.448968887329,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 16,
          "epoch": 0,
          "loss": 1.3021419048309326,
          "accuracy": 47.22222222222222,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.4162704111688099,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1518.8369750976562,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 17,
          "epoch": 0,
          "loss": 1.2602649927139282,
          "accuracy": 54.83870967741935,
          "batch_size": 31,
          "learning_rate": 0.0005,
          "epsilon": 0.42222362528939117,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1301.1839389801025,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 18,
          "epoch": 0,
          "loss": 1.3613930940628052,
          "accuracy": 34.78260869565217,
          "batch_size": 23,
          "learning_rate": 0.0005,
          "epsilon": 0.42817683940997253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1275.8350372314453,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 19,
          "epoch": 0,
          "loss": 1.2558178901672363,
          "accuracy": 54.285714285714285,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.4341300535305538,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1624.1519451141357,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 20,
          "epoch": 0,
          "loss": 1.2855077981948853,
          "accuracy": 46.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.44008326765113503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1597.1651077270508,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 21,
          "epoch": 0,
          "loss": 1.2966867685317993,
          "accuracy": 48.484848484848484,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.4460364817717163,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1486.9868755340576,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 22,
          "epoch": 0,
          "loss": 1.3270289897918701,
          "accuracy": 37.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.45198969589229765,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1266.7572498321533,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 23,
          "epoch": 0,
          "loss": 1.2575923204421997,
          "accuracy": 52.17391304347826,
          "batch_size": 46,
          "learning_rate": 0.0005,
          "epsilon": 0.4579429100128789,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1936.3558292388916,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 24,
          "epoch": 0,
          "loss": 1.2758618593215942,
          "accuracy": 46.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.46389612413346015,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1483.9251041412354,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 25,
          "epoch": 0,
          "loss": 1.3530155420303345,
          "accuracy": 35.8974358974359,
          "batch_size": 39,
          "learning_rate": 0.0005,
          "epsilon": 0.4698493382540415,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1737.3859882354736,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 26,
          "epoch": 0,
          "loss": 1.2584810256958008,
          "accuracy": 48.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.47580255237462277,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1018.9177989959717,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 27,
          "epoch": 0,
          "loss": 1.330682396888733,
          "accuracy": 38.23529411764706,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.481755766495204,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1483.386754989624,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 28,
          "epoch": 0,
          "loss": 1.3323315382003784,
          "accuracy": 35.714285714285715,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.4877089806157854,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1244.5251941680908,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 29,
          "epoch": 0,
          "loss": 1.2807376384735107,
          "accuracy": 45.945945945945944,
          "batch_size": 37,
          "learning_rate": 0.0005,
          "epsilon": 0.49366219473636663,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1683.6440563201904,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 30,
          "epoch": 0,
          "loss": 1.3137966394424438,
          "accuracy": 41.37931034482759,
          "batch_size": 29,
          "learning_rate": 0.0005,
          "epsilon": 0.4996154088569479,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1147.6590633392334,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 31,
          "epoch": 0,
          "loss": 1.230555534362793,
          "accuracy": 52.63157894736842,
          "batch_size": 38,
          "learning_rate": 0.0005,
          "epsilon": 0.5055686229775292,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1778.2728672027588,
          "gpu_memory_mb": 0.0
        }
      ]
    }
  ],
  "final_train_loss": 1.3120084516704082,
  "final_train_accuracy": 46.048780487804876,
  "final_eval_accuracy": 25.4,
  "final_epsilon": 0.5055686229775292,
  "final_delta": 0.001,
  "allocation_metrics": {
    "strategy_name": "cube_root_gradient_norm_private",
    "layer_clipping_bounds": {
      "other": 1.0
    },
    "allocation_ratios": {
      "other": 1.0
    },
    "global_clipping_bound": 1.0,
    "constraint_value": 1.0,
    "estimated_gradient_norms": {
      "other": 0.07860086435217699
    },
    "estimation_samples": 100,
    "privacy_cost_epsilon": 0.1,
    "used_public_data": false,
    "allocation_time_seconds": 3.5208442211151123
  },
  "model_name": "distilbert-base-uncased",
  "total_parameters": 67623944,
  "trainable_parameters": 667396,
  "lora_enabled": true,
  "total_training_time_seconds": 55.61766290664673,
  "peak_gpu_memory_mb": 0.0,
  "start_time": "2025-12-01T15:21:09.291032",
  "end_time": "2025-12-01T15:22:04.908694",
  "experiment_type": "dp",
  "strategy_name": "cube_root_gradient_norm_private",
  "metadata": {}
}