{
  "experiment_name": "dp_uniform_lora",
  "config": {
    "name": "fast_comparison",
    "output_dir": "./experiment_results",
    "model_name": "distilbert-base-uncased",
    "dataset_name": "ag_news",
    "max_train_samples": 1000,
    "max_test_samples": 500,
    "max_length": 32,
    "batch_size": 32,
    "epochs": 1,
    "learning_rate": 0.0005,
    "weight_decay": 0.01,
    "seed": 42,
    "lora_rank": 4,
    "lora_alpha": 8,
    "lora_dropout": 0.1,
    "lora_target_modules": [
      "q_lin",
      "v_lin"
    ],
    "target_epsilon": 0.5,
    "target_delta": null,
    "max_grad_norm": 1.0,
    "gradient_estimation_samples": 50,
    "use_public_data_for_estimation": false,
    "run_no_dp": true,
    "run_strategies": [
      "uniform",
      "gradient_norm",
      "cube_root_gradient_norm",
      "depth_linear_increasing"
    ],
    "device": "cpu"
  },
  "epochs": [
    {
      "epoch": 0,
      "train_loss": 1.3182071819901466,
      "train_accuracy": 46.951219512195124,
      "eval_loss": 1.4361867159605026,
      "eval_accuracy": 25.4,
      "epsilon": 0.5055686229775292,
      "delta": 0.001,
      "mean_gradient_norm": null,
      "mean_clipped_fraction": null,
      "epoch_time_seconds": 54.57912802696228,
      "peak_gpu_memory_mb": 0.0,
      "steps": [
        {
          "step": 0,
          "epoch": 0,
          "loss": 1.37371826171875,
          "accuracy": 41.935483870967744,
          "batch_size": 31,
          "learning_rate": 0.0005,
          "epsilon": 0.2770724088773902,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1390.807867050171,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 1,
          "epoch": 0,
          "loss": 1.3421088457107544,
          "accuracy": 46.15384615384615,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.29779567541520474,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1088.6781215667725,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 2,
          "epoch": 0,
          "loss": 1.3548145294189453,
          "accuracy": 53.84615384615385,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.3057646202295503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1106.3120365142822,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 3,
          "epoch": 0,
          "loss": 1.3582097291946411,
          "accuracy": 40.0,
          "batch_size": 25,
          "learning_rate": 0.0005,
          "epsilon": 0.3137335650438959,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 983.7889671325684,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 4,
          "epoch": 0,
          "loss": 1.353743076324463,
          "accuracy": 45.714285714285715,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.32170250985824145,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1378.370761871338,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 5,
          "epoch": 0,
          "loss": 1.3700790405273438,
          "accuracy": 37.03703703703704,
          "batch_size": 27,
          "learning_rate": 0.0005,
          "epsilon": 0.32967145467258696,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1016.556978225708,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 6,
          "epoch": 0,
          "loss": 1.3300138711929321,
          "accuracy": 44.11764705882353,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.33764039948693253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1412.45698928833,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 7,
          "epoch": 0,
          "loss": 1.3070189952850342,
          "accuracy": 72.41379310344827,
          "batch_size": 29,
          "learning_rate": 0.0005,
          "epsilon": 0.3456093443012781,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1099.8568534851074,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 8,
          "epoch": 0,
          "loss": 1.3354910612106323,
          "accuracy": 42.857142857142854,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.3535782891156236,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 937.903881072998,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 9,
          "epoch": 0,
          "loss": 1.3584234714508057,
          "accuracy": 38.095238095238095,
          "batch_size": 21,
          "learning_rate": 0.0005,
          "epsilon": 0.3615472339299692,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 702.2829055786133,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 10,
          "epoch": 0,
          "loss": 1.3180845975875854,
          "accuracy": 52.94117647058823,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.36951617874431475,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 2041.227102279663,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 11,
          "epoch": 0,
          "loss": 1.364768147468567,
          "accuracy": 32.35294117647059,
          "batch_size": 34,
          "learning_rate": 0.0005,
          "epsilon": 0.37748512355866026,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1958.0810070037842,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 12,
          "epoch": 0,
          "loss": 1.323853850364685,
          "accuracy": 48.57142857142857,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.38545406837300583,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1699.458122253418,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 13,
          "epoch": 0,
          "loss": 1.348955512046814,
          "accuracy": 36.666666666666664,
          "batch_size": 30,
          "learning_rate": 0.0005,
          "epsilon": 0.3934230131873514,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1383.835792541504,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 14,
          "epoch": 0,
          "loss": 1.2682218551635742,
          "accuracy": 60.526315789473685,
          "batch_size": 38,
          "learning_rate": 0.0005,
          "epsilon": 0.4013919580016969,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1928.97367477417,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 15,
          "epoch": 0,
          "loss": 1.2822513580322266,
          "accuracy": 57.142857142857146,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.4093609028160425,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1221.987247467041,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 16,
          "epoch": 0,
          "loss": 1.3022923469543457,
          "accuracy": 48.648648648648646,
          "batch_size": 37,
          "learning_rate": 0.0005,
          "epsilon": 0.4162704111688099,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1691.171646118164,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 17,
          "epoch": 0,
          "loss": 1.2580368518829346,
          "accuracy": 62.5,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.42222362528939117,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1933.579921722412,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 18,
          "epoch": 0,
          "loss": 1.2859439849853516,
          "accuracy": 50.0,
          "batch_size": 26,
          "learning_rate": 0.0005,
          "epsilon": 0.42817683940997253,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1196.5761184692383,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 19,
          "epoch": 0,
          "loss": 1.3264007568359375,
          "accuracy": 42.857142857142854,
          "batch_size": 35,
          "learning_rate": 0.0005,
          "epsilon": 0.4341300535305538,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1464.5750522613525,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 20,
          "epoch": 0,
          "loss": 1.342134714126587,
          "accuracy": 35.714285714285715,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.44008326765113503,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1335.702657699585,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 21,
          "epoch": 0,
          "loss": 1.3039770126342773,
          "accuracy": 46.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.4460364817717163,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1652.2719860076904,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 22,
          "epoch": 0,
          "loss": 1.3314427137374878,
          "accuracy": 42.42424242424242,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.45198969589229765,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1574.5728015899658,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 23,
          "epoch": 0,
          "loss": 1.2033882141113281,
          "accuracy": 65.9090909090909,
          "batch_size": 44,
          "learning_rate": 0.0005,
          "epsilon": 0.4579429100128789,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 2145.623207092285,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 24,
          "epoch": 0,
          "loss": 1.191162347793579,
          "accuracy": 62.06896551724138,
          "batch_size": 29,
          "learning_rate": 0.0005,
          "epsilon": 0.46389612413346015,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1419.1532135009766,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 25,
          "epoch": 0,
          "loss": 1.2637954950332642,
          "accuracy": 46.875,
          "batch_size": 32,
          "learning_rate": 0.0005,
          "epsilon": 0.4698493382540415,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1494.7922229766846,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 26,
          "epoch": 0,
          "loss": 1.3247172832489014,
          "accuracy": 37.5,
          "batch_size": 24,
          "learning_rate": 0.0005,
          "epsilon": 0.47580255237462277,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1081.5560817718506,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 27,
          "epoch": 0,
          "loss": 1.3209723234176636,
          "accuracy": 38.888888888888886,
          "batch_size": 36,
          "learning_rate": 0.0005,
          "epsilon": 0.481755766495204,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1463.1590843200684,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 28,
          "epoch": 0,
          "loss": 1.453393578529358,
          "accuracy": 19.047619047619047,
          "batch_size": 21,
          "learning_rate": 0.0005,
          "epsilon": 0.4877089806157854,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 785.546064376831,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 29,
          "epoch": 0,
          "loss": 1.2065945863723755,
          "accuracy": 54.54545454545455,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.49366219473636663,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1553.117036819458,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 30,
          "epoch": 0,
          "loss": 1.3590394258499146,
          "accuracy": 32.142857142857146,
          "batch_size": 28,
          "learning_rate": 0.0005,
          "epsilon": 0.4996154088569479,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1372.6940155029297,
          "gpu_memory_mb": 0.0
        },
        {
          "step": 31,
          "epoch": 0,
          "loss": 1.3195819854736328,
          "accuracy": 42.42424242424242,
          "batch_size": 33,
          "learning_rate": 0.0005,
          "epsilon": 0.5055686229775292,
          "delta": null,
          "gradient_norm": null,
          "clipped_fraction": null,
          "layer_gradient_norms": null,
          "layer_clipping_fractions": null,
          "step_time_ms": 1646.4390754699707,
          "gpu_memory_mb": 0.0
        }
      ]
    }
  ],
  "final_train_loss": 1.3182071819901466,
  "final_train_accuracy": 46.951219512195124,
  "final_eval_accuracy": 25.4,
  "final_epsilon": 0.5055686229775292,
  "final_delta": 0.001,
  "allocation_metrics": {
    "strategy_name": "uniform",
    "layer_clipping_bounds": {
      "other": 1.0
    },
    "allocation_ratios": {
      "other": 1.0
    },
    "global_clipping_bound": 1.0,
    "constraint_value": 1.0,
    "estimated_gradient_norms": null,
    "estimation_samples": 0,
    "privacy_cost_epsilon": 0.0,
    "used_public_data": false,
    "allocation_time_seconds": 0.2564690113067627
  },
  "model_name": "distilbert-base-uncased",
  "total_parameters": 67623944,
  "trainable_parameters": 667396,
  "lora_enabled": true,
  "total_training_time_seconds": 54.83894491195679,
  "peak_gpu_memory_mb": 0.0,
  "start_time": "2025-12-01T15:19:20.938246",
  "end_time": "2025-12-01T15:20:15.777188",
  "experiment_type": "dp",
  "strategy_name": "uniform",
  "metadata": {}
}